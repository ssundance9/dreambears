<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StatDao">

    <select id="selectHittingStatBySeason" resultType="com.dream.bears.model.BatterRecord">
        SELECT A.*
        FROM    (
            SELECT  SEASON
                    , NAME
                    , SUBSTRING(NAME, 1, 3) NAME2
                    , SUM(1) AS GAMES
                    , SUM(PLATE_APPEARS) AS PLATE_APPEARS
                    , SUM(AT_BATS) AS AT_BATS
                    , SUM(HITS) AS HITS
                    , SUM(SINGLES) AS SINGLES
                    , SUM(DOUBLES) AS DOUBLES
                    , SUM(TRIPLES) AS TRIPLES
                    , SUM(HOME_RUNS) AS HOME_RUNS
                    , SUM(RUNS_SCORED) AS RUNS_SCORED
                    , SUM(RUNS_BATTED_IN) AS RUNS_BATTED_IN
                    , SUM(BASES_ON_BALLS) AS BASES_ON_BALLS
                    , SUM(STRIKE_OUTS) AS STRIKE_OUTS
                    , SUM(STOLEN_BASES) AS  STOLEN_BASES
            FROM    BATTER_RECORD
            WHERE   SEASON = #{season}
            GROUP BY SEASON, NAME
            UNION ALL
            SELECT  SEASON
                    , 'TOTAL'
                    , 'TOTAL'
                    , 1
                    , SUM(PLATE_APPEARS) AS PLATE_APPEARS
                    , SUM(AT_BATS) AS AT_BATS
                    , SUM(HITS) AS HITS
                    , SUM(SINGLES) AS SINGLES
                    , SUM(DOUBLES) AS DOUBLES
                    , SUM(TRIPLES) AS TRIPLES
                    , SUM(HOME_RUNS) AS HOME_RUNS
                    , SUM(RUNS_SCORED) AS RUNS_SCORED
                    , SUM(RUNS_BATTED_IN) AS RUNS_BATTED_IN
                    , SUM(BASES_ON_BALLS) AS BASES_ON_BALLS
                    , SUM(STRIKE_OUTS) AS STRIKE_OUTS
                    , SUM(STOLEN_BASES) AS  STOLEN_BASES
            FROM    BATTER_RECORD
            WHERE   SEASON = #{season}
            GROUP BY SEASON
        ) A
        ORDER BY A.NAME2 ASC
    </select>

    <select id="selectPichingStatBySeason" resultType="com.dream.bears.model.PitcherRecord">
        SELECT A.*
        FROM    (
            SELECT  SEASON
                    , NAME
                    , SUBSTRING(NAME, 1, 3) NAME2
                    , SUM(1) AS GAMES
                    , SUM(WINS) AS WINS
                    , SUM(LOSSES) AS LOSSES
                    , SUM(SAVES) AS SAVES
                    , SUM(INNINGS_PITCHED) AS INNINGS_PITCHED
                    , SUM(PLATE_APPEARS) AS PLATE_APPEARS
                    , SUM(AT_BATS) AS AT_BATS
                    , SUM(HITS) AS HITS
                    , SUM(HOME_RUNS) AS HOME_RUNS
                    , SUM(SACRIFICE_FLY) AS SACRIFICE_FLY
                    , SUM(BASES_ON_BALLS) AS BASES_ON_BALLS
                    , SUM(STRIKE_OUTS) AS STRIKE_OUTS
                    , SUM(RUNS) AS  RUNS
                    , SUM(EARNED_RUNS) AS EARNED_RUNS
            FROM    PITCHER_RECORD
            WHERE   SEASON = #{season}
            GROUP BY SEASON, NAME
            UNION ALL
            SELECT  SEASON
                    , 'TOTAL'
                    , 'TOTAL'
                    , 1
                    , SUM(WINS) AS WINS
                    , SUM(LOSSES) AS LOSSES
                    , SUM(SAVES) AS SAVES
                    , SUM(INNINGS_PITCHED) AS INNINGS_PITCHED
                    , SUM(PLATE_APPEARS) AS PLATE_APPEARS
                    , SUM(AT_BATS) AS AT_BATS
                    , SUM(HITS) AS HITS
                    , SUM(HOME_RUNS) AS HOME_RUNS
                    , SUM(SACRIFICE_FLY) AS SACRIFICE_FLY
                    , SUM(BASES_ON_BALLS) AS BASES_ON_BALLS
                    , SUM(STRIKE_OUTS) AS STRIKE_OUTS
                    , SUM(RUNS) AS  RUNS
                    , SUM(EARNED_RUNS) AS EARNED_RUNS
            FROM    PITCHER_RECORD
            WHERE   SEASON = #{season}
            GROUP BY SEASON

        ) A
        ORDER BY A.NAME2
    </select>

    <select id="selectHittingStatByGame" resultType="com.dream.bears.model.BatterRecord">
        SELECT A.*
        FROM    (
            SELECT  NAME
                    , SUBSTRING(NAME, 1, 3) NAME2
                    , PLATE_APPEARS
                    , AT_BATS
                    , HITS
                    , SINGLES
                    , DOUBLES
                    , TRIPLES
                    , HOME_RUNS
                    , RUNS_SCORED
                    , RUNS_BATTED_IN
                    , BASES_ON_BALLS
                    , STRIKE_OUTS
                    , STOLEN_BASES
            FROM    BATTER_RECORD
            WHERE   YEAR = #{year}
            AND     MONTH = #{month}
            AND     DATE = #{date}
            AND     GAME_SEQ = #{gameSeq}
            UNION ALL
            SELECT  'TOTAL'
                    , 'TOTAL'
                    , SUM(PLATE_APPEARS) AS PLATE_APPEARS
                    , SUM(AT_BATS) AS AT_BATS
                    , SUM(HITS) AS HITS
                    , SUM(SINGLES) AS SINGLES
                    , SUM(DOUBLES) AS DOUBLES
                    , SUM(TRIPLES) AS TRIPLES
                    , SUM(HOME_RUNS) AS HOME_RUNS
                    , SUM(RUNS_SCORED) AS RUNS_SCORED
                    , SUM(RUNS_BATTED_IN) AS RUNS_BATTED_IN
                    , SUM(BASES_ON_BALLS) AS BASES_ON_BALLS
                    , SUM(STRIKE_OUTS) AS STRIKE_OUTS
                    , SUM(STOLEN_BASES) AS  STOLEN_BASES
            FROM    BATTER_RECORD
            WHERE   YEAR = #{year}
            AND     MONTH = #{month}
            AND     DATE = #{date}
            AND     GAME_SEQ = #{gameSeq}
        ) A
        ORDER BY A.NAME2 ASC
    </select>

    <select id="selectTeamStatsBySeason" resultType="com.dream.bears.model.TeamRecord">
        SELECT *
        FROM    TEAM_RECORD
        WHERE   SEASON = #{season}
        ORDER BY YEAR, MONTH, DATE, GAME_SEQ
    </select>

</mapper>

